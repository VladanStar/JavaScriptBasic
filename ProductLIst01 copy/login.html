<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>ListProduct Northwind</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
    />
	<meta charset="utf-8" />
	<meta name="author" content="Suzana" />
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> 


	<!--	Links -->
	<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.11.3.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<link rel="icon" href="img/favicon-book.ico" sizes="16x16 32x32" type="image/ico" />
	<link href="https://fonts.googleapis.com/css?family=Oswald" rel="stylesheet">

</head>

<body id="login">
	<div class="login-content">
		<label>Username:<br>
			<input type="text" id="user" placeholder="ANATR">
		</label><br>
		<label>Password:<br>
			<input type="password" id="pass" placeholder="ANATR">
		</label>
		<button id="loginBtn">Log in</button>
		<p id="msg"></p>
	</div>

	<!-- Script -->
	<script>
		var customersUrl = "https://services.odata.org/v4/Northwind/Northwind.svc/Customers";
		var customers = getServiceData(customersUrl).value;

		document.getElementById("loginBtn").addEventListener("click", function() {
			var user = document.getElementById("user").value;
			var pass = document.getElementById("pass").value;
			login(user, pass, customers);
		});

		function login(user, pass, customers) {

			var userLogin = false;
			for (var i in customers) {
				if (customers[i].CustomerID === user && customers[i].CustomerID == pass) {
					userLogin = true;
					break;
				}
			}
			if (userLogin) {
				sessionStorage.setItem("userLogin", "true");
				window.location.href = "index.html";
			} else {
				document.getElementById("msg").innerHTML = "Invalid data";
			}
		}

		function getServiceData(url, username, password) {

			try {
				var result;
				var xmlhttp = new XMLHttpRequest();
				xmlhttp.onreadystatechange = function() {
					if (xmlhttp.readyState == 4) {
						if (xmlhttp.status == 200) {
							result = JSON.parse(xmlhttp.response);
						} else {
							return false;
						}
					}
				}
				xmlhttp.open("GET", url, false, username, password);
				xmlhttp.send();
				return result;
			} catch (err) {
				return err;
			}
		}

	</script>
</body>

</html>
